<!DOCTYPE html>
<html>
<head>
    <title>Jellyfeatured</title>
</head>
<body>
    <div data-role="page">
        <div data-role="content">
            <h2>Jellyfeatured Plugin</h2>
            <p>This plugin adds a featured content section to your homepage.</p>
            
            <script type="text/javascript">
                // Auto-inject script into parent window (homepage)
                function injectIntoHomepage() {
                    try {
                        // Try to access the main Jellyfin window
                        const targetWindow = window.parent !== window ? window.parent : window.top;
                        
                        if (targetWindow && targetWindow.document) {
                            const script = targetWindow.document.createElement('script');
                            script.innerHTML = `
                                (function() {
                                    function createFeaturedDiv() {
                                        if (document.getElementById('jellyfeatured-div')) return;
                                        
                                        const homeElements = [
                                            '.homePage',
                                            '.homePageContent',
                                            '.view.pageContainer',
                                            '[data-role="main"]',
                                            '.scrollY',
                                            '.pageContainer'
                                        ];
                                        
                                        let container = null;
                                        for (const selector of homeElements) {
                                            container = document.querySelector(selector);
                                            if (container) break;
                                        }
                                        
                                        if (container) {
                                            const featuredDiv = document.createElement('div');
                                            featuredDiv.id = 'jellyfeatured-div';
                                            featuredDiv.style.cssText = 'width: 100%; height: 200px; background-color: #000; margin: 20px 0; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; font-weight: bold; position: relative; z-index: 1000; border: 2px solid #333;';
                                            featuredDiv.innerHTML = 'ðŸŽ¬ Jellyfeatured Plugin Active! ðŸŽ¬';
                                            
                                            container.insertBefore(featuredDiv, container.firstChild);
                                            console.log('âœ… Jellyfeatured: Successfully injected featured div!');
                                        }
                                    }
                                    
                                    // Multiple injection attempts
                                    createFeaturedDiv();
                                    setTimeout(createFeaturedDiv, 500);
                                    setTimeout(createFeaturedDiv, 1000);
                                    setTimeout(createFeaturedDiv, 2000);
                                    
                                    // Listen for navigation changes
                                    const observer = new MutationObserver(() => {
                                        setTimeout(createFeaturedDiv, 100);
                                    });
                                    observer.observe(document.body, { childList: true, subtree: true });
                                })();
                            `;
                            targetWindow.document.head.appendChild(script);
                            console.log('Jellyfeatured: Script injected into main window');
                        }
                    } catch (e) {
                        console.log('Jellyfeatured: Could not inject into parent window:', e);
                    }
                }
                
                // Try injection when this page loads
                setTimeout(injectIntoHomepage, 1000);
                
                // Also run the injection directly in this window context
                (function() {
                    function createFeaturedDiv() {
                        if (document.getElementById('jellyfeatured-div')) return;
                        
                        const homeElements = [
                            '.homePage',
                            '.homePageContent', 
                            '.view.pageContainer',
                            '[data-role="main"]',
                            '.scrollY',
                            '.pageContainer',
                            'body'
                        ];
                        
                        let container = null;
                        for (const selector of homeElements) {
                            container = document.querySelector(selector);
                            if (container) break;
                        }
                        
                        if (container) {
                            const featuredDiv = document.createElement('div');
                            featuredDiv.id = 'jellyfeatured-div';
                            featuredDiv.style.cssText = 'width: 100%; height: 200px; background-color: #000; margin: 20px 0; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; font-size: 18px; font-weight: bold; position: relative; z-index: 1000; border: 2px solid #333;';
                            featuredDiv.innerHTML = 'ðŸŽ¬ Jellyfeatured Plugin Active! ðŸŽ¬';
                            
                            container.insertBefore(featuredDiv, container.firstChild);
                            console.log('âœ… Jellyfeatured: Successfully injected featured div!');
                        }
                    }
                    
                    createFeaturedDiv();
                    setTimeout(createFeaturedDiv, 500);
                    setTimeout(createFeaturedDiv, 1000);
                })();
            </script>
        </div>
    </div>
</body>
</html>